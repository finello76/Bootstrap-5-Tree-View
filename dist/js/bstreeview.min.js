/*! @preserve
 * bstreeview.js
 * Version: 1.2.1
 * Authors: Sami CHNITER <sami.chniter@gmail.com>, Andrea Fini <andrea.fini@gmail.com>
 * Copyright 2020
 * License: Apache License 2.0
 *
 * Project: https://github.com/chniter/bstreeview
 * Project: https://github.com/nhmvienna/bs5treeview (bootstrap 5)
 * Project: https://github.com/finello76/Bootstrap-5-Tree-View (bootstrap 5.3)
 */
!function(t,e,s,n){"use strict";let i={expandIcon:"fa fa-angle-down fa-fw",collapseIcon:"fa fa-angle-right fa-fw",expandClass:"show",indent:1.25,chevronIntent:1,parentsMarginLeft:1.25,openNodeLinkOnNewTab:!0},a='<div class="lh-lg" data-bs-toggle="collapse" role="button"></div>',d='<div class="lh-lg collapse" id="itemid"></div>',r='<i class="state-icon"></i>',o='<i class="item-icon"></i>';function l(e,s){this.element=e,this.itemIdPrefix=e.id+"-item-",this.settings=t.extend({},i,s),this.init()}t.extend(l.prototype,{init:function(){this.tree=[],this.nodes=[],this.settings.data&&(this.settings.data.isPrototypeOf(String)&&(this.settings.data=t.parseJSON(this.settings.data)),this.tree=t.extend(!0,[],this.settings.data),this._tree||(this._tree=JSON.parse(JSON.stringify(this.tree))),delete this.settings.data),t(this.element).addClass("list-group"),this.initData({nodes:this.tree});let s=this;this.build(t(this.element),this.tree,0),t(this.element).off("click"),t(this.element).on("click",'[data-bs-toggle="collapse"]',(function(n){let i=t(".state-icon",this);i.hasClass(s.settings.expandIcon)?(i.removeClass(s.settings.expandIcon),i.addClass(s.settings.collapseIcon)):(i.removeClass(s.settings.collapseIcon),i.addClass(s.settings.expandIcon)),n.target.hasAttribute("href")&&(s.settings.openNodeLinkOnNewTab?e.open(n.target.getAttribute("href"),"_blank"):e.location=n.target.getAttribute("href"))}))},initData:function(e){if(!e.nodes)return;let s=e,n=this;t.each(e.nodes,(function(t,e){e.nodeId=n.nodes.length,e.parentId=s.nodeId,n.nodes.push(e),e.nodes&&n.initData(e)}))},reset:function(e){this.settings.data=e,t(this.element).empty(),this.init()},search:function(t,e){if(t.length>0){let s=(new JsonSearch).searchAndReturnStructure(this._tree,t,e);this.reset(s)}else this.reset(this._tree)},build:function(e,s,n){let i=this;n+=1,t.each(s,(function(s,l){let h=i.settings.parentsMarginLeft;n>0&&(h=(n-1)*i.settings.indent),l.nodes||(h+=i.settings.chevronIntent);let c=t(a).attr("data-bs-target","#"+i.itemIdPrefix+l.nodeId).attr("style","padding-left:"+h+"rem");if(l.nodes){let e=t(r).addClass(l.expanded?i.settings.expandIcon:i.settings.collapseIcon);c.append(e)}if(l.icon){let e=t(o).addClass(l.icon);c.append(e)}if(c.append(l.text),l.href&&c.attr("href",l.href),l.class&&c.addClass(l.class),l.id&&c.attr("id",l.id),e.append(c),l.nodes){let s=t(d).attr("id",i.itemIdPrefix+l.nodeId);e.append(s),i.build(s,l.nodes,n),l.expanded&&s.addClass(i.settings.expandClass)}}))}}),t.fn.bstreeview=function(e){return this.each((function(){t.data(this,"plugin_bstreeview")||t.data(this,"plugin_bstreeview",new l(this,e))}))}}(jQuery,window,document);class JsonSearch{searchAndReturnStructure(t,e,s){let n=new Array;return t.forEach((t=>{const i={};for(let a in t)if("nodes"===a&&Array.isArray(t[a])){const n=this.searchAndReturnStructure(t[a],e,s);if(n.length>0){for(let e in t)i[e]=t[e];i[a]=n}}else{if("text"===a&&"string"==typeof t[a]&&this.match(t[a],e,s))return n.push(t);"object"==typeof t[a]&&null!==t[a]&&(i[a]=t[a])}Object.keys(i).length>0&&n.push(i)})),n}match(t,e,s){return s&&(t=t.toLowerCase(),e=e.toLowerCase()),t.includes(e)}}